<html><meta charset="UTF-8"><style>html { 
    font-size: 100%; 
    overflow-y: scroll; 
    -webkit-text-size-adjust: 100%; 
    -ms-text-size-adjust: 100%; 
}

body{
    font-family: helvetica, arial, freesans, clean, sans-serif;
    color: #333;
    background-color: #fff;
    border-color: #999999;
    border-width: 2px;
    line-height: 1.5;
    margin: 2em 3em;
    text-align:left;
    padding: 0 100px 0 100px;
}

pre{
    background-color: #eee;
    padding: 10px;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    overflow: auto;
}
code{
    background-color: #eee;
    padding: 1px 3px;
    -webkit-border-radius: 2px;
    -moz-border-radius: 2px;
    border-radius: 2px; 
}
pre code {
    padding-left: 0px;
    padding-right: 0px;
}
li p{
    margin: 0.3em;
}
ul > li{
    list-style-type: disc;
}
a:link, a:visited{
    color: #33e;
    text-decoration: none;
}
a:hover{
    color: #00f;
    text-shadow:1px 1px 2px #ccf;
    text-decoration:underline;
}
h1{
    color: #999;
    font-weight: 400;
    font-size: 36px;
}
h2{
    border-bottom: 1px dotted #aaa;
    margin-bottom: 1em;
    color: #333;
    font-size: 30px;
}
h3{
    color: #666;
    font-size: 24px;
}
h4 {
    font-size: 21px;
}
h5 {
    font-size: 18px;
}
.shadow{
    -webkit-box-shadow:0 5px 15px #000;
    -moz-box-shadow:0 5px 15px #000;
    box-shadow:0 5px 15px #000;     
}
</style><body><h1>Chapter 1</h1>
<h2>Gather your Cartographer's Toolbox</h2>
<p>Friday afternoon. You're sitting in your desk and your boss drops on you out of nowhere. - "Hey there Mr. computer genius, Mr. I am able to create anything. I have a challenge for you."</p>
<p>"We have a high visibility client that is looking to visualize their data within space!"</p>
<p>"Space you mean... like Mars?"</p>
<p>"No no no, space as in the land mass throughout this so called earth. Maps I tell you maps! All we have to do is create a cool looking map that shows the clients sales across all of Europe, you know with colors and events and stuff, so that the board of directors click and play with it and create what-if scenarios and bla bla bla."</p>
<p>And so the journey begins. Your first reaction is to think, now is the time where I hit the "I'm looking for a job" button on one of the various job seeking sites out there and run as fast as you can. But no, you decide to go ahead and bravely venture where no one else has ventured before... building maps on your own!</p>
<p>Now lets be honest here, maps have existed almost as long as man itself. It probably started when he decided to call this, this and that that, and drew a line in the middle. That separation created a mental division of here and there and by which humanity would define itself as them and us.</p>
<p>Nuts right!</p>
<p>Anyway, looping back to reality you start to deconstruct the problem like the good programmer you are and decide to tackle it via the browser. Of course! If I create an app that sits on a server everyone in the board will be able to access the site from their computers and interact with the map and data. And who else can come to the rescue but the map grandpappy of them all, Google maps.</p>
<p>So you quickly head to Google maps and manage to create a vanilla hello world style map powered by Google and start to think - man I am a genius, bonus here I come!
Until your boss walks in again and drops the design for the given map. At first glance you think - wow! our designer must have been locked in his creative room all weekend trying to make the most rainbow bright map in the planet! Then you realize that what you have in front of you is called a heat map.</p>
<pre><code>** Image of heatmap
</code></pre>
<p>You realize it’s not just putting markers on the map, but visualizing the data on top of the map. Interesting...
No problemo, I'm sure I can handle this via Google maps. But wait a second, once again you get struck by the bolt of thought (yes it’s a bolt) and you realize that the data you have cannot sit on a public server. It has to be within the control of the company and to the eyes of the board only. You are dealing with very sensitive data and if it where to fall in the wrong hands who knows what fate the company might hold.</p>
<p>“Crap!” you cry out loud, “I'm doomed!”</p>
<p>You desperately start searching the web for tools. You dig in again and learn concepts like tile maps, spacial data, QGIS software and yadda yadda. But nothing seems to look like this piece of art your designer has so cleverly replicated.
Until you Google once again and suddenly find a link to a library called D3.js. You click on it and see that this magical thing can create all kinds of stunning visualizations and to your luck it can create maps!
Right but what about the data? How the heck do I get the data go power this amazing piece of magic? Google has pictures of your back yard that were taken by satellites, how the heck are you going to tap into that!</p>
<p>But then you click again and come to this link right here (make sure we acknowledge this)</p>
<p><a href="http://bl.ocks.org/mbostock/4060606">The USA in Choropleth mode</a></p>
<p>Boom!</p>
<p>Exactly what you were looking for, only it’s a different continent but hey, it's got the colors that your designer was looking for and reading from the legend seems like you can bind those colors to data and visualize it. Maybe there is a way to obtain data of the world in free manner with out having to hack your way into satellites. You breathe deeply and decide to give it a shot</p>
<p>Welcome, my dear friend, to the world of maps powered by D3js.</p>
<p>In this chapter we will get you set up with all you will need in order to create a map with D3js. All these tools exist freely an openly thanks to the wonderful world of open source. Given that we are going to be speaking web our languages will be HTML, CSS and JavaScript. But lets not waste any time in details, trust me in the end you will get it.</p>
<p>When creating maps in d3, your toolbox is extraordinarily light.   The goal is to focus on creating the data visualization and remove the burden of heavy IDE’s and map-making software.  The fundamental building blocks are:</p>
<ol>
<li>A lightweight web server</li>
<li>topojson – a tool for managing and optimizing geographic information</li>
<li>A web browser capable of rendering SVG (we highly recommend Google Chrome)</li>
<li>The d3.js library</li>
</ol>
<h2>Using Python as a Lightweight WebServer</h2>
<p>Running a web server in your local development environment provides several benefits:</p>
<ol>
<li>Geographic Information, statistical data, and visualization code can be cleanly separated.</li>
<li>API calls can be stubbed and simulated allowing easy integration into an application later.</li>
<li>Prevents common issues when making AJAX calls</li>
</ol>
<p>The Python scripting language has a built-in module that creates a lightweight webserver for you.  This webserver can be launched from any directory on your computer and will allow you to view the contents in your web browser.  While not recommended for production, it is a perfect fit for our development cycle.  Python is free, easy to install, and has other modules that can be used for data processing and statistical analysis.</p>
<h3>Installing Python on a Windows machine</h3>
<ul>
<li>Go to this link <a href="https://www.python.org/">https://www.python.org/</a></li>
<li>Click on downloads</li>
<li>Click on windows</li>
<li>Click on the python 2.7 release</li>
<li>Click on windows x86 MSI installer or the 64 if you have a 64 bit</li>
<li>Once download click through the installer and leave all default configurations</li>
<li>Add Python to your path<ul>
<li>Right Click My Computer -&gt; Properties -&gt; Advanced System Settings -&gt; Environment Variables</li>
<li>Under the "System variables" section find Path and edit</li>
<li>Append: ";C:\python27"</li>
<li>Click Ok to save</li>
</ul>
</li>
<li>Validate that it is installed<ul>
<li>Click start</li>
<li>Type cmd in 'search' and click cmd.exe</li>
<li>Then type python --version and you should see python 2.7</li>
</ul>
</li>
<li>Congratulations you now have Python installed!</li>
</ul>
<h3>Running python on a Mac</h3>
<p>Macs already come with python installed, so this should be a piece of cake.</p>
<ul>
<li>Open your terminal</li>
<li>type in python --version</li>
<li>You should see a version of python show up either 2.7 or 3</li>
</ul>
<h2>topojson</h2>
<p>topojson is a command line utility used to create files in the TopoJSON serialized format.  We will go in depth on how and why to use TopoJSON in Chapter 4. The topojson utility requires node and is installed via the Node Package Manager (NPM)</p>
<p>To do so for both Mac Linux and Windows machines you will need to:</p>
<ol>
<li>Go to the website <a href="http://nodejs.org/">http://nodejs.org/</a></li>
<li>Click on the Install button. (It should automatically detect which operating system you are running and give you the right installer)</li>
<li>Follow through the installation and leave all the default configurations.</li>
<li>Once it is done you should be able to open your terminal or command prompt and type node --version</li>
<li>You should see the version of node show up.</li>
</ol>
<p>Now that we have Node and NPM installed let's get topojson
Simply go to your terminal and type</p>
<pre><code>npm install topojson
</code></pre>
<p>Once the installation is complete you should be able to check for the version of topojson installed on your machine just like we did with Python and Node.</p>
<pre><code>$topojson --version
</code></pre>
<p>If you are able to see a version 1.6.x that means you have successfully installed topojson. Don't worry if you have no clue what these tools are for. We will go through them in detail throughout this book. Once you start using TopoJSON you will truly realize the power of it.</p>
<p>Now that you have a way of running python on your machine you are able to instantiate a local server very easily. This will allow you to make Ajax request to your data. You want to be able to make Ajax requests to your data because the data for your map will be living outside of your map code. This might all seem very confusing but for now just follow the lead. To give you an idea of what we are talking about we've created a starter repo for you.</p>
<h2>Viewing the Map</h2>
<p>Click this link <a href="http://github/something">link to the first demo code base</a> and either clone the repo if you are familiar with cloning or simply download the zipped version. Once downloaded make sure to extract the file if you have it zipped.
Use the command prompt or terminal to go to the directory where you downloaded your file. For instance if you Downloaded the file to your desktop you use cd Directory Name to move to a given directory.</p>
<pre><code>$cd ~/Desktop
$Desktop cd D3MapExamples
$D3MapExamples python -m SimpleHTTPServer
</code></pre>
<p>The last command is the most important one for it will launch a python simple server. This means that if you open your browser and go to localhost:8000 you should see a list with all of the code for all the chapters in this book that you've just downloaded. If you click inside of them you will be automatically directed to the index.html file living inside of those folders / chapters.</p>
<p>So far if you have followed the explanation you should be seeing a map of Europe on your browser. Yes it just so happens to look exactly like the map your boss asked you for, the first one is on us =).</p>
<h2>Using the Web Browser as a Development Tool</h2>
<p>Take your time to appreciate whats going on. The best way to do this is by exploring the code you are seeing rendered on your browser.</p>
<p>We strongly recommend you use Google Chrome browser for these examples. It comes bundled with something called the Developer Tools which will allow you to very easily open, explore and modify the code you are looking at. If you are not using Google Chrome right now please go to this link and install Google Chrome.</p>
<p><a href="http://google.com/chrome">http://google.com/chrome</a></p>
<p>If you already have Chrome open and the URL says localhost:8000/Chapter1/index.html and you are looking at a map, it's time to open the Dev Tools. On the top right of the browser you will see an icon like such</p>
<pre><code>''' image of icon '''
</code></pre>
<p>click it. This opens a sub-menu. Click on tools and then on Developer Tools.
This will open a section like so ''' image of the Dev Tools'''
For quick key access on macs use alt + command + I on pcs use ''''''
Within the Dev Tools you have a series of tabs. These are the</p>
<p><em>Elements
</em>Network
<em>Sources
</em>Timeline
<em>Profiles
</em>Resources
<em>Audits
</em>Console.</p>
<p>They are all extremely valuable tools that allow you to inspect different aspects of the code you are creating. For now we are going to focus on the Elements tab. Click on it if it is not already selected.
You should see something like this (image of the HTML elements tab). If you click on the</p>
<pre><code>&lt;svg width="812" height="584"&gt;
</code></pre>
<p>item you should see it expand and show another tag called the path tag. That path tag will have a bunch of numbers tied to id 'd' attribute. Those numbers are basically and effectively drawing the map. You see the path tag is a way to draw paths in this world of SVG. We will dig deeper into what SVG is an how it works in conjunction with the browser and building maps. But basically our code is telling the path move to point A and draw a line to point B. Then draw a line to point C, then D etc.</p>
<p>You might be thinking this is gong to be a daunting task if I have to manually type in all those move commands, but worry not obi-one, D3 will do it for us.</p>
<p>The other thing we want to draw your attention to is the fact that we have and HTML5 application that is loading the D3js library. Again in the Elements tag after the SVG tag you should see the script tag pointing to d3.js which we have cleverly put inside of your folder for your convenience. Keep in mind that you can either point to the a CDN (Content Delivery Network) server which holds the library such as</p>
<pre><code>&lt;script src="http://d3js.org/d3.v3.min.js" charset="utf-8"&gt;&lt;/script&gt;
</code></pre>
<p>or you can put it within your code base in case you aren't sure if your users are actually going to be viewing this a stand alone application (one that is not connected to the Internet). Given that our board of directors will be in a locked sound proof room, Internet access is null, therefore having the D3js library as part of our application is a must.</p>
<p>If you click on the path located inside of the SVG tag you will see that on the right something has changed. That panel / section is called the CSS inspector or the styles inspector. This shows / controls all of the styles that are applied to a given selected element, in this case the path element.</p>
<p>These 3 things, HTML5 (the SVG and path elements), JavaScript (the d3js library and map code) and CSS (the styling of the HTML5 elements) is what compromises a D3 visualization. It is this 3 things that we will be exploring throughout the book and learning how to use in order to create maps and visualizations.</p></body></html>